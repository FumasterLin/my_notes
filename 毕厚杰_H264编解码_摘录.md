

![image-20200730174509120](https://cdn.jsdelivr.net/gh//fumasterlin/cloudimg/notes_img/20200730174547.png)



6.2.2 H.264 编码器
编码器采用的仍是变换和预测的混合编码法。
由图 6.1，输入的帧或场 Fn 以宏块为单位被编码器处理。首先，按帧内或帧间预测编码的方法进行处理。
如果采用帧内预测编码，其预测值 PRED（图中用 P 表示）是由当前片中前面已编码的参考图像经运动补偿（ MC）后得出，其中参考图像用 F’n-1 表示。为了提高预测精度，从而提高压缩比，实际的参考图像可在过去或未来（指显示次序上）已编码解码重建和滤波的帧中进行选择。
预测值 PRED 和当前块相减后，产生一个残差块 Dn，经块变换、量化后产生一组量化后的变换系数 X，再经熵编码，与解码所需的一些边信息（如预测模式量化参数、运动矢量等）一起组成一个压缩后的码流，经 NAL（网络自适应层）供传输和存储用。正如上述，为了提供进一步预测用的参考图像，编码器必须有重建图像的功能。因此必须使残差图像经反量化、反变换后得到的 Dn’与预测值 P 相加，得到 uFn’（未经滤波的帧）。为了去除编码解码环路中产生的噪声，为了提高参考帧的图像质量，从而提高压缩图像性能，设置了一个环路滤波器，滤波后的输出 Fn’即重建图像可用作参考图像。

6.2.3 H.264 解码器
由图 6.1 可知，由编码器的 NAL 输出一个压缩后的 H.264 压缩比特流。由图 6.2，经熵解码得到量化后的一组变换系数 X，再经反量化、反变换，得到残差 Dn’。利用从该比特流中解码出的头信息， 解码器就产生一个预测块 PRED， 它和编码器中的原始 PRED 是相同的。 当该解码器产生的 PRED与残差 Dn’相加后，就产生 uFu’，再经滤波后，最后就得到滤波后的 Fn’，这个 Fn’就是最后的解码输出图像。  







![image-20200730175938883](https://cdn.jsdelivr.net/gh//fumasterlin/cloudimg/notes_img/20200730180036.png)

![image-20200730180219767](https://cdn.jsdelivr.net/gh//fumasterlin/cloudimg/notes_img/20200730180219.png)

![image-20200730181215767](https://cdn.jsdelivr.net/gh//fumasterlin/cloudimg/notes_img/20200730181250.png)